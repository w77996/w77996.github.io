(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{196:function(s,e,n){"use strict";n.r(e);var a=n(0),t=Object(a.a)({},function(){var s=this,e=s.$createElement,n=s._self._c||e;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h1",{attrs:{id:"稻草人图床神器小程序"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#稻草人图床神器小程序","aria-hidden":"true"}},[s._v("#")]),s._v(" 稻草人图床神器小程序")]),s._v(" "),n("h2",{attrs:{id:"项目结构"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#项目结构","aria-hidden":"true"}},[s._v("#")]),s._v(" 项目结构")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("mini-straw\n    ├── component -- 组件\n    |    ├── file -- 文件组件\n    |    ├── image-button -- 图片按钮组件\n    |    ├── search -- 查找页面组件\n    |    ├── tag -- 标签组件\n    ├── images -- 图片目录\n    |    ├── icon -- icon图片\n    |    ├── tab -- tab图片\n    ├── model -- 封装的model\n    ├── pages -- 页面\n    |    ├── about -- 关于页\n    |    ├── auth -- 授权页\n    |    ├── file -- 文件页\n    |    ├── index -- 首页\n    |    ├── launch -- 启动页面\n    |    ├── my -- 个人中心\n    └── utils -- 工具\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br")])]),n("h2",{attrs:{id:"开屏页"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#开屏页","aria-hidden":"true"}},[s._v("#")]),s._v(" 开屏页")]),s._v(" "),n("h3",{attrs:{id:"_1-判断网络状态"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-判断网络状态","aria-hidden":"true"}},[s._v("#")]),s._v(" 1.判断网络状态")]),s._v(" "),n("p",[s._v("使用"),n("code",[s._v("wx.getNetworkType({})")]),s._v("可获取当前网络状态，"),n("code",[s._v("networkType")]),s._v("值"),n("code",[s._v("wifi/2g/3g/4g/unknown(Android下不常见的网络类型)/none(无网络)")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v(" //判断网络状态\nwx.getNetworkType({\n    success: res => {\n    if (res.networkType == \"none\") {\n        wx.showToast({\n            title: '嗷~~网络不可用',\n            icon: 'none',\n            duration: 2000\n        })\n        return;\n    }\n    },\n})\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br")])]),n("h3",{attrs:{id:"_2-判断授权状态"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-判断授权状态","aria-hidden":"true"}},[s._v("#")]),s._v(" 2.判断授权状态")]),s._v(" "),n("p",[s._v("使用"),n("code",[s._v("wx.getSetting({})")]),s._v("获取授权状态，在获得"),n("code",[s._v("data")]),s._v("后取"),n("code",[s._v("data.authSetting['scope.userInfo']")]),s._v("判断授权状态")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v(" // 获取授权的状态\nwx.getSetting({\n    success: data => {\n    if (data.authSetting['scope.userInfo']) {\n        //已授权，执行登陆\n        wx.getUserInfo({\n            success: data => {\n                    console.log(\"userInfo {}\", data)\n                    let userInfo = data.userInfo;\n                    wx.setStorageSync('userInfo', userInfo);\n                    //执行登陆操作\n                    this._userLoginGetCode(userInfo);\n            }\n        });\n        wx.setStorageSync('authorized', true);\n    } else {\n        console.log(\"未授权\")\n        //跳转至授权页\n        let timer = setTimeout(() => {\n                wx.redirectTo({\n                        url: '/pages/auth/auth'\n                })\n        }, 2000)\n\n    }\n    }\n});\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br")])]),n("p",[s._v("若授权，则调用"),n("code",[s._v("wx.getUserInfo({})")]),s._v("获取微信用户信息，信息获取完成后调用"),n("code",[s._v("wx.login({})")]),s._v("获取小程序的"),n("code",[s._v("code")]),s._v(",通过"),n("code",[s._v("code")]),s._v("向后台获取用户openId及token。")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('//后台获取code\n_userLoginGetCode(userInfo) {\n    console.log("发起_userLoginGetCode请求");\n    wx.login({\n        success(res) {\n        console.log("wx.login {}", res);\n        if (res.code) {\n            // 发起网络请求\n            const code = res.code;\n            userInfo.code = code;\n            userModel.getTokenByCode(userInfo).then((res) => {\n                console.log("userModel getUserInfo {}", res);\n                wx.setStorageSync("token", res.data.data.token);\n                let timer = setTimeout(() =>\n                    wx.switchTab({\n                            url: \'/pages/index/index\',\n                    }), 2000)\n            });\n        } else {\n                console.log(\'登录失败！\' + res.errMsg)\n        }\n        }\n    })\n},\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br")])]),n("h3",{attrs:{id:"_3-跳转页面"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-跳转页面","aria-hidden":"true"}},[s._v("#")]),s._v(" 3.跳转页面")]),s._v(" "),n("ul",[n("li",[s._v("跳转"),n("code",[s._v("/pages/auth/auth")]),s._v("页面使用的是"),n("code",[s._v("wx.redirectTo({})")])]),s._v(" "),n("li",[s._v("跳转"),n("code",[s._v("/pages/index/index")]),s._v("页面使用的是"),n("code",[s._v("wx.switchTab({})")]),n("br"),s._v("\n因为"),n("code",[s._v("/pages/index/index")]),s._v("是小程序tab页，使用"),n("code",[s._v("wx.redirectTo({})")]),s._v("无法跳转")])]),s._v(" "),n("h2",{attrs:{id:"授权页"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#授权页","aria-hidden":"true"}},[s._v("#")]),s._v(" 授权页")]),s._v(" "),n("p",[s._v("授权需制定button按钮，加入"),n("code",[s._v("open-type='getUserInfo'")]),s._v("属性，"),n("code",[s._v("bindgetuserinfo")]),s._v("调用自定义方法"),n("code",[s._v("onGetUserInfo")]),s._v("。")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v(' <button class="auth-button" open-type=\'getUserInfo\' bindgetuserinfo="onGetUserInfo">好的</button>\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[n("code",[s._v("onGetUserInfo")]),s._v("接受授权状态及授权获取的用户信息，再进行"),n("code",[s._v("code")]),s._v("获取，通过"),n("code",[s._v("code")]),s._v("向后台获取用户openId及token。")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("onGetUserInfo: function(e) {\n    console.log(e)\n    const userInfo = e.detail.userInfo;\n    if (userInfo) {\n            //通过`code`向后台获取用户openId及token。\n            this._userLoginGetCode(userInfo);\n    }\n},\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("h2",{attrs:{id:"主页"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#主页","aria-hidden":"true"}},[s._v("#")]),s._v(" 主页")]),s._v(" "),n("h3",{attrs:{id:"_1-图片按钮插槽组件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-图片按钮插槽组件","aria-hidden":"true"}},[s._v("#")]),s._v(" 1. 图片按钮插槽组件")]),s._v(" "),n("p",[s._v("在"),n("code",[s._v("component")]),s._v("目录下的"),n("code",[s._v("images-button")]),s._v("组件，做了简单的图片插槽统一，在分享按钮，用户登录按钮，文件上传按钮均可以使用。"),n("code",[s._v('plain="'+s._s(!0)+'"')]),s._v("代表button背景透明")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('<button  open-type="{{openType}}" plain="{{true}}" class="container">\n  <slot name="img"></slot>\n</button>\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("p",[n("code",[s._v("options")]),s._v("需要开启插槽功能，添加"),n("code",[s._v("multipleSlots: true")]),n("br"),s._v(" "),n("code",[s._v('open-type="'+s._s(s.openType)+'"')]),s._v("父组件将参数传入子组件，子组件在"),n("code",[s._v("properties")]),s._v("属性中可以获取到父组件传来的openType数据，通过"),n("code",[s._v("this.properties.openType")]),s._v("可以获取属性值")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("options: {\n    // 开启插槽\n    multipleSlots: true\n  },\n/**\n   * 组件的属性列表\n   */\n  properties: {\n    openType: {\n      type: String\n    }\n  },\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br")])]),n("p",[n("code",[s._v("index")]),s._v("页面引入组件，需要在"),n("code",[s._v("index.json")]),s._v("中添加组件路径")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('{\n  "usingComponents": {\n    "btn-cmp": "/component/image-button/index"\n  }\n}\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("h3",{attrs:{id:"_2-上传文件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-上传文件","aria-hidden":"true"}},[s._v("#")]),s._v(" 2. 上传文件")]),s._v(" "),n("p",[s._v("主要使用到"),n("code",[s._v("wx.chooseImage({})")]),s._v("进行图片的选择，选择后使用"),n("code",[s._v("wx.uploadFile({})")]),s._v("上传图片至服务器")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("//上传文件\nonUpload(event) {\nlet _this = this;\nwx.chooseImage({\n  count: 1, // 默认9\n  sizeType: ['original', 'compressed'], // 可以指定是原图还是压缩图，默认二者都有\n  sourceType: ['album', 'camera'], // 可以指定来源是相册还是相机，默认二者都有\n  success: function(res) {\n    // 返回选定照片的本地文件路径列表，tempFilePath可以作为img标签的src属性显示图片\n    let tempFilePaths = res.tempFilePaths;\n    console.log(tempFilePaths)\n    wx.uploadFile({\n      header: {\n        \"Authorization\": \"Bearer \" + wx.getStorageSync(\"token\")\n      },\n      url: config.apiBaseUrl + '/file/upload',\n      filePath: tempFilePaths[0],\n      name: 'file',\n      success: (res) => {\n        wx.showToast({\n          title: \"上传成功~\",\n          icon: 'none',\n          duration: 2000\n        })\n      },\n      fail: (res) => {\n        wx.showToast({\n          title: res.data.msg,\n          icon: 'none',\n          duration: 2000\n        })\n      }\n    })\n\n  }\n})\n}\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br")])]),n("h2",{attrs:{id:"列表页"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#列表页","aria-hidden":"true"}},[s._v("#")]),s._v(" 列表页")]),s._v(" "),n("h3",{attrs:{id:"_1-search组件的显示和隐藏"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-search组件的显示和隐藏","aria-hidden":"true"}},[s._v("#")]),s._v(" 1.search组件的显示和隐藏")]),s._v(" "),n("p",[s._v("固定列表页搜索header位置，点击header显示"),n("code",[s._v("search")]),s._v("组件，在"),n("code",[s._v("search")]),s._v("组件点击取消则隐藏"),n("code",[s._v("search")]),s._v("组件，此处设计子组件向父组件传递消息")]),s._v(" "),n("ul",[n("li",[s._v("引入search组件")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v(' "usingComponents": {\n    ...\n    "search-cmp": "/component/search/index"\n  }\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("ul",[n("li",[s._v("使用searchPage参数判断"),n("code",[s._v("search")]),s._v("组件的,默认为false,在点击header时更新searchPage为true,显示"),n("code",[s._v("search")]),s._v("组件")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('<view wx:if="{{!searchPage}}" class="container">\n  ...\n</view>\n\n<search-cmp  wx:if="{{searchPage}}" ></search-cmp>\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("ul",[n("li",[n("code",[s._v("search")]),s._v("页面点击取消，向父组件发送一个"),n("code",[s._v("this.triggerEvent('cancel', {}, {});")]),s._v("事件，在xml中的"),n("code",[s._v("search-cmp")]),s._v("添加"),n("code",[s._v("cancel")]),s._v("事件的通知绑定")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('#file页面中的search-cmp组件\n<search-cmp  wx:if="{{searchPage}}" bind:cancel="onCancel"></search-cmp>\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[s._v("父组件"),n("code",[s._v("file")]),s._v("页面绑定子组件传来的"),n("code",[s._v("cancel")]),s._v("事件通知，就调用"),n("code",[s._v("onCancel")]),s._v("方法,\n在"),n("code",[s._v("onCancel")]),s._v("方法中获取事件响应，将"),n("code",[s._v("searchPage")]),s._v("参数修改为false，"),n("code",[s._v("search")]),s._v("组件就隐藏起来了")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("//cancel searching page \nonCancel(event) {\n  console.info(event)\n  this.triggerEvent('cancel', {}, {});\n \n},\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("h3",{attrs:{id:"_2-文件列表"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-文件列表","aria-hidden":"true"}},[s._v("#")]),s._v(" 2.文件列表")]),s._v(" "),n("h4",{attrs:{id:"_1-获取列表信息传递给file组件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-获取列表信息传递给file组件","aria-hidden":"true"}},[s._v("#")]),s._v(" 1.获取列表信息传递给file组件")]),s._v(" "),n("p",[s._v("在"),n("code",[s._v("page")]),s._v("中的file页面，获取到后台传来的fileList数据，引入file组件，"),n("code",[s._v('file="'+s._s(s.item)+'"')]),s._v("将数据传入子组件")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('<view wx:if="{{fileList}}">\n  <block wx:for="{{fileList}}" wx:key="{{item.id}}" file="{{item}}">\n    <file-cmp file="{{item}}" bind:del="onDelete"></file-cmp>\n    <view class="line"></view>\n  </block>\n</view>\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("p",[s._v("在"),n("code",[s._v("component")]),s._v("中的file组件，在"),n("code",[s._v("properties")]),s._v("添加属性"),n("code",[s._v("file")]),s._v("来接收父组件传来的数据,\nfile的组件在xml页面中使用file.fileName即可获取到对象信息，相应的数据也会呈现在页面上")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("  /**\n   * 组件的属性列表\n   */\n  properties: {\n    file: Object\n  }\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("h4",{attrs:{id:"_2-粘贴板操作"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-粘贴板操作","aria-hidden":"true"}},[s._v("#")]),s._v(" 2.粘贴板操作")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('<image src="images/copy.png" bindtap="onCopy"></image>\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("图片点击响应方法"),n("code",[s._v("onCopy")]),s._v("，"),n("code",[s._v("onCopy")]),s._v("调用"),n("code",[s._v("wx.setClipboardData({})")]),s._v("可以将数据复制到粘贴板")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("    \n    onCopy: function (event) {\n      console.info(event)\n      let _this = this;\n      wx.setClipboardData({\n        data: _this.properties.file.filePath,\n        success: function(res) {\n          wx.showToast({\n            title: '图片地址复制成功',\n          })\n        }\n      });\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br")])]),n("h4",{attrs:{id:"_3-删除操作"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-删除操作","aria-hidden":"true"}},[s._v("#")]),s._v(" 3.删除操作")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('<image src="images/del.png" bindtap="onDelete"></image>\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("子组件将数据传递给父组件，点击删除图片出发"),n("code",[s._v("onDelete")]),s._v("方法,通过"),n("code",[s._v("this.triggerEvent('del', {fileId}, {});")]),s._v("将文件ID发送到父组件")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("    onDelete: function (event) {\n      console.info(event)\n      let fileId = this.properties.file.id;\n      this.triggerEvent('del', {fileId}, {});\n    },\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("p",[s._v("父组件file页面绑定子组件传来的"),n("code",[s._v("del")]),s._v("事件")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('<file-cmp file="{{item}}" bind:del="onDelete"></file-cmp>\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("调用"),n("code",[s._v("onDelete")]),s._v("出发网络请求去完成删除文件的逻辑,删除成功后重新刷新文件列表")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v(" //删除图片\nonDelete(event) {\n    console.info(\"DEL\")\n    console.info(event)\n    let fileId = event.detail.fileId;\n    fileModel.delFileById(fileId).then((res) => {\n        console.info(res);\n        wx.showToast({\n                title: '删除成功',\n        })\n        this.setData({\n                pageNum: 1,\n                fileList: []\n        });\n        this._getFileList();\n    })\n},\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br")])]),n("h2",{attrs:{id:"我的页面"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#我的页面","aria-hidden":"true"}},[s._v("#")]),s._v(" 我的页面")]),s._v(" "),n("h3",{attrs:{id:"_1-意见和建议"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-意见和建议","aria-hidden":"true"}},[s._v("#")]),s._v(" 1.意见和建议")]),s._v(" "),n("p",[s._v("小程序自带用户反馈功能，使用"),n("code",[s._v("button")]),s._v("跳转至网页，用户可以填写相关反馈,"),n("code",[s._v("open-type")]),s._v("设置为"),n("code",[s._v("feedback")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('<button class="about-btn" plain="true" open-type="feedback">\n    <text class="about-btn-text">反馈建议</text>\n</button>\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("h3",{attrs:{id:"_2-小程序客服"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-小程序客服","aria-hidden":"true"}},[s._v("#")]),s._v(" 2.小程序客服")]),s._v(" "),n("p",[s._v("小程序的"),n("code",[s._v("button")]),s._v("中的"),n("code",[s._v("open-type")]),s._v("拥有开放能力,在微信公众平台中启用客服功能，添加客服人员，在代码中添加"),n("code",[s._v("button")]),s._v("即可弹出客服聊天界面,"),n("code",[s._v("open-type")]),s._v("设置为"),n("code",[s._v("contact")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v(' <button class="about-btn" plain="true" open-type="contact" bindcontact="handleContact">\n    <text class="about-btn-text">联系客服</text>\n</button>\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("h3",{attrs:{id:"_3-小程序分享"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-小程序分享","aria-hidden":"true"}},[s._v("#")]),s._v(" 3.小程序分享")]),s._v(" "),n("p",[s._v("此处使用插槽,"),n("code",[s._v("button")]),s._v("中的"),n("code",[s._v("open-type")]),s._v("设置为"),n("code",[s._v("share")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('<btn-cmp open-type="share">\n    <image slot="img" src="images/share.png" />\n</btn-cmp>\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("h2",{attrs:{id:"动画"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#动画","aria-hidden":"true"}},[s._v("#")]),s._v(" 动画")]),s._v(" "),n("p",[n("a",{attrs:{href:"https://developers.weixin.qq.com/miniprogram/dev/api/wx.createAnimation.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("小程序动画官方文档"),n("OutboundLink")],1),n("br"),s._v("\n开屏动画，设置文字透明度，从0到1，渐渐显示，主要使用到"),n("code",[s._v("opacity")]),s._v("去设置组件的透明度，先创建一个动画"),n("code",[s._v("animationTip")]),s._v(",持续800ms,然后在"),n("code",[s._v("setTimeout(function () {})")]),s._v("中设置动画出现时间")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v(" var animationTip = wx.createAnimation({\n      //持续时间800ms\n      duration: 800,\n      timingFunction: 'ease',\n    });\n    this.animationTip = animationTip;\n    animationTip.opacity(0).step()\n    this.setData({\n      animationTip: animationTip.export()\n    })\n    setTimeout(function () {\n      animationTip.opacity(1).step()\n      this.setData({\n        animationTip: animationTip.export()\n      })\n    }.bind(this), 500)\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br")])]),n("h2",{attrs:{id:"部署"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#部署","aria-hidden":"true"}},[s._v("#")]),s._v(" 部署")]),s._v(" "),n("ol",[n("li",[s._v("修改"),n("code",[s._v("utils")]),s._v("目录下的"),n("code",[s._v("config.apiBaseUrl")]),s._v(",改成自己的域名，上传到微信公众号平台，在版本管理中进行发布")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('const config ={\n   apiBaseUrl: "你自己的域名或服务器地址"\n}\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])])])},[],!1,null,null,null);e.default=t.exports}}]);